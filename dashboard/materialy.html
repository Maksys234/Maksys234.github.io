<!DOCTYPE html>
<html lang="cs" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Justax - AI Math Tutor // Kyber-Verze</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800&family=Inter:wght@400;500;600;700&family=Roboto+Mono:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="profile.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

</head>
<body class="dark">
    <div class="initial-loading-overlay" id="initial-loader">
        <div class="loading-spinner"></div>
        <p>NAČÍTÁNÍ AI TUTORA...</p>
    </div>

    <div class="offline-banner" id="offline-banner"> <i class="fas fa-plug"></i> OFFLINE // SPOJENÍ ZTRACENO.</div>

    <div class="sidebar-overlay" id="sidebar-overlay"></div>

    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <button class="mobile-menu-toggle" id="sidebar-close-toggle" aria-label="Zavřít menu">
                <i class="fas fa-times"></i>
            </button>
            <a href="/dashboard/dashboard.html" class="sidebar-logo"> <i class="fas fa-atom"></i> <span>Justax</span> </a>
        </div>
        <ul class="sidebar-menu">
             <li class="sidebar-item"> <a href="/dashboard/dashboard.html" class="sidebar-link"> <i class="fas fa-tachometer-alt"></i> <span>Nástěnka</span> </a> </li>
             <li class="sidebar-item"> <a href="/dashboard/procvicovani/main.html" class="sidebar-link"> <i class="fas fa-laptop-code"></i> <span>Procvičování</span> </a> </li>
             <li class="sidebar-item"> <a href="/dashboard/pokrok.html" class="sidebar-link"> <i class="fas fa-chart-line"></i> <span>Pokrok</span> </a> </li>
             <li class="sidebar-item"> <a href="/dashboard/oceneni.html" class="sidebar-link"> <i class="fas fa-medal"></i> <span>Ocenění</span> </a> </li>
             <li class="sidebar-item"> <a href="/dashboard/materialy.html" class="sidebar-link"> <i class="fas fa-database"></i> <span>Databanka</span> </a> </li>
             <li class="sidebar-item"> <a href="/dashboard/ai_math_tutor.html" class="sidebar-link active"> <i class="fas fa-robot"></i> <span>AI Tutor Matiky</span> </a> </li>
             <li class="sidebar-item"> <a href="/dashboard/profile.html" class="sidebar-link"> <i class="fas fa-user-astronaut"></i> <span>Profil</span> </a> </li>
        </ul>
        <div class="user-profile">
            <div class="user-avatar" id="sidebar-avatar">?</div>
            <div class="user-info">
                <div class="user-name" id="sidebar-name">Načítání...</div>
                <div class="user-role">Pilot</div>
            </div>
        </div>
        <div class="sidebar-footer"> &copy; <span id="currentYearSidebar">2025</span> Justax Systems </div>
    </aside>

    <main id="main-content">
        <header class="dashboard-header">
            <div class="header-content">
                 <div>
                     <button class="mobile-menu-toggle" id="main-mobile-menu-toggle" aria-label="Otevřít menu">
                         <i class="fas fa-bars"></i>
                     </button>
                     <h1><i class="fas fa-robot"></i> AI Tutor Matematiky</h1>
                 </div>
                 <div class="header-actions">
                     <button id="placeholder-action-btn" class="btn btn-secondary">Akce</button>
                 </div>
            </div>
        </header>

        <div class="main-content-wrapper">
            <section class="section ai-tutor-section">
                <h2 class="section-title"><i class="fas fa-video"></i> Video Chat a Hodnocení</h2>
                <div id="ai-tutor-interface">
                    <p>Tady bude rozhraní pro video chat s AI tutorem...</p>
                    <div id="video-call-placeholder" style="border: 1px dashed var(--accent-primary); min-height: 300px; display: flex; align-items: center; justify-content: center; margin-bottom: 1rem;">
                        [ Placeholder pro Video stream a ovládání ]
                    </div>
                    <div id="chat-placeholder" style="border: 1px dashed var(--accent-secondary); min-height: 200px; display: flex; align-items: center; justify-content: center;">
                        [ Placeholder pro Chat rozhraní ]
                    </div>
                    <div id="assessment-placeholder" style="margin-top: 1rem; padding: 1rem; background: var(--card-solid); border-radius: var(--form-element-radius);">
                        [ Oblast pro zobrazení otázek, odpovědí, hodnocení AI ]
                    </div>
                </div>
            </section>

            <footer class="dashboard-footer">
                <p>&copy; <span id="currentYearFooter">2025</span> Justax Systems // Secure Channel</p>
            </footer>
        </div>
    </main>

    <div class="toast-container" id="toast-container"></div>
    <div id="mouse-follower" class="mouse-follower-glow"></div>

    <script>
        // Basic setup for sidebar, theme, etc. - adapt from profile.js or dashboard.js
        (function() {
            console.log("AI Math Tutor Page Loaded");
            // Add necessary JS initialization (sidebar toggle, theme, etc.)
            // You'll need to adapt the core JS logic from other dashboard pages
             // Placeholder for core logic
             const initializeCore = () => {
                  // Based on profile.js or dashboard.js logic
                  const mobileToggle = document.getElementById('main-mobile-menu-toggle');
                  const closeToggle = document.getElementById('sidebar-close-toggle');
                  const overlay = document.getElementById('sidebar-overlay');
                  const sidebar = document.getElementById('sidebar');

                  const openMenu = () => { sidebar?.classList.add('active'); overlay?.classList.add('active'); };
                  const closeMenu = () => { sidebar?.classList.remove('active'); overlay?.classList.remove('active'); };

                  mobileToggle?.addEventListener('click', openMenu);
                  closeToggle?.addEventListener('click', closeMenu);
                  overlay?.addEventListener('click', closeMenu);

                  // Update copyright year
                  const yearSpan = document.getElementById('currentYearFooter');
                  const yearSpanSidebar = document.getElementById('currentYearSidebar');
                  if (yearSpan) yearSpan.textContent = new Date().getFullYear();
                  if (yearSpanSidebar) yearSpanSidebar.textContent = new Date().getFullYear();

                  // Hide loader, show content
                   const loader = document.getElementById('initial-loader');
                   const main = document.getElementById('main-content');
                   if(loader) {
                        loader.classList.add('hidden');
                        setTimeout(() => { if(loader) loader.style.display = 'none'; }, 600);
                   }
                   if(main) {
                        main.style.display = 'block'; // Use 'block' or 'flex' based on your main layout
                        requestAnimationFrame(() => main.classList.add('loaded'));
                   }
             };
             initializeCore();

            // --- Placeholder for AI Tutor Logic ---
            // This is where you would integrate:
            // 1. WebRTC library (e.g., Agora, Twilio, Jitsi, or native WebRTC) for video call.
            // 2. Chat UI implementation.
            // 3. Connection to an AI API (like Gemini API) for question generation and evaluation.
            // 4. Logic to manage the assessment flow (asking, timing, evaluating).
            // 5. Supabase integration to fetch user level and save results.
            console.log("TODO: Implement WebRTC, Chat UI, AI API connection, and assessment logic here.");

        })();
    </script>

</body>
</html>