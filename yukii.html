<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>💖 Happy 15th Birthday, Yuki! 💖</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Pacifico&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.min.js"></script> <style>
        /* --- Base & Theme --- */
        :root {
            --bg-start: #fff1f2; --bg-mid: #ffe4e6; --bg-end: #fecdd3;
            --accent-pink: #f472b6; --accent-purple: #c084fc;
            --text-dark: #4b5563; --text-header: #db2777;
            --daisy-center: #fffbeb; --daisy-petal: white;
            --confetti-1: #fbcfe8; --confetti-2: #f9a8d4;
            --confetti-3: #fef9c3; --confetti-4: white;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-mid); /* Base color */
            background-image:
                /* Subtle dot pattern */
                radial-gradient(circle, rgba(244, 114, 182, 0.08) 1px, transparent 1px),
                /* Base gradient */
                linear-gradient(145deg, var(--bg-start), var(--bg-mid), var(--bg-end));
            background-size: 20px 20px, 100% 100%; /* Size for dot pattern and gradient */
            overflow-x: hidden;
            min-height: 100vh;
            position: relative;
            padding: 2rem 1rem 6rem 1rem;
            color: var(--text-dark);
        }

        /* --- Typography --- */
        .font-heading {
            font-family: 'Pacifico', cursive;
            color: var(--text-header);
            text-shadow: 1px 1px 3px rgba(255, 255, 255, 0.6);
        }

        /* --- Daisy Styles & Animations --- */
        .css-daisy {
            display: inline-block; width: 22px; height: 22px;
            background-color: var(--daisy-center); border-radius: 50%;
            position: relative; margin: 6px; vertical-align: middle;
            box-shadow: 0 2px 4px rgba(0,0,0,0.08); z-index: 1;
            border: 1px solid rgba(255, 255, 255, 0.5);
            transition: transform 0.3s ease; /* Add transition for hover */
        }
        .css-daisy::before, .css-daisy::after, .css-daisy .petal {
            content: ''; position: absolute; background-color: var(--daisy-petal);
            border-radius: 50% 0 50% 0; box-shadow: inset 0 0 3px rgba(0,0,0,0.05);
            width: 10px; height: 28px; top: -3px; left: 6px;
            transform-origin: 50% 100%; z-index: 0;
        }
        .css-daisy::before { transform: rotate(-10deg); }
        .css-daisy::after { transform: rotate(80deg); }
        .css-daisy .petal { /* Class for JS-added petals */ }

        /* Hover effect for static daisies */
        .static-daisy:hover {
             transform: scale(1.2) rotate(15deg);
             cursor: pointer; /* Indicate interactivity */
        }

        /* Falling Daisy Animation */
        .falling-daisy {
            position: absolute;
            animation: fall 12s linear infinite, sway 3.5s ease-in-out infinite alternate; /* Slightly slower */
            user-select: none; pointer-events: none; z-index: 0;
        }
        @keyframes fall {
            0% { transform: translateY(-10vh) rotate(0deg) scale(0.7); opacity: 0; }
            10% { opacity: 0.8; } 90% { opacity: 0.6; }
            100% { transform: translateY(110vh) rotate(600deg) scale(1); opacity: 0; }
        }
        @keyframes sway { from { transform: translateX(-8px); } to { transform: translateX(8px); } } /* Wider sway */

        /* Gentle pulse */
        @keyframes pulse-gentle { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }
        .daisy-pulse { animation: pulse-gentle 3s ease-in-out infinite; }

        /* --- Card Styles --- */
        .card {
            background-color: rgba(255, 255, 255, 0.97); /* Even more opaque */
            backdrop-filter: blur(20px); border-radius: 35px; /* Even rounder */
            box-shadow: 0 18px 40px rgba(100, 100, 100, 0.12), 0 0 20px rgba(255, 255, 255, 0.6) inset;
            transition: transform 0.5s cubic-bezier(0.25, 0.8, 0.25, 1), box-shadow 0.5s cubic-bezier(0.25, 0.8, 0.25, 1);
            position: relative; z-index: 10; border: 1px solid white;
            opacity: 0; transform: translateY(40px);
            animation: cardAppear 1.2s cubic-bezier(0.25, 0.8, 0.25, 1) forwards;
            background-image: linear-gradient(rgba(255,255,255,0.03) 1px, transparent 1px), linear-gradient(90deg, rgba(255,255,255,0.03) 1px, transparent 1px);
            background-size: 25px 25px;
        }
        .card-delay-1 { animation-delay: 0.7s; } .card-delay-2 { animation-delay: 1.9s; } .card-delay-3 { animation-delay: 2.5s; } /* Delay for new card */

        @keyframes cardAppear { from { opacity: 0; transform: translateY(40px) scale(0.98); } to { opacity: 1; transform: translateY(0) scale(1); } }
        .card:hover { transform: translateY(-12px) scale(1.03); box-shadow: 0 22px 50px rgba(100, 100, 100, 0.18), 0 0 25px rgba(255, 255, 255, 0.8) inset; }

        /* --- Image Styling --- */
         .profile-image-container {
            position: relative; display: inline-block; padding: 12px; border-radius: 50%;
            background: linear-gradient(60deg, var(--bg-mid), var(--accent-pink));
            box-shadow: 0 8px 25px rgba(219, 39, 119, 0.3);
            transition: transform 0.4s ease, box-shadow 0.4s ease; /* Added shadow transition */
         }
         .profile-image-container:hover {
             transform: scale(1.08) rotate(3deg); /* More zoom/tilt */
             box-shadow: 0 12px 35px rgba(219, 39, 119, 0.4); /* Enhanced shadow */
         }
        .profile-image { border: 5px solid white; display: block; }
        /* Daisy Chain Frame */
        .daisy-frame-item {
            position: absolute; z-index: 15; transform: scale(0.6);
            animation: pulse-gentle 4s ease-in-out infinite;
            /* Apply .css-daisy styles via class */
        }
        .daisy-frame-item:nth-child(1) { top: -5px; left: 50%; transform: translate(-50%, -50%) scale(0.6) rotate(10deg); animation-delay: -0.5s;}
        .daisy-frame-item:nth-child(2) { top: 15%; right: -5px; transform: translate(50%, -50%) scale(0.6) rotate(80deg); animation-delay: -1.5s;}
        .daisy-frame-item:nth-child(3) { bottom: -5px; left: 50%; transform: translate(-50%, 50%) scale(0.6) rotate(190deg); animation-delay: -2.5s;}
        .daisy-frame-item:nth-child(4) { top: 15%; left: -5px; transform: translate(-50%, -50%) scale(0.6) rotate(270deg); animation-delay: -3.5s;}
        .daisy-frame-item:nth-child(5) { top: 65%; right: -5px; transform: translate(50%, 50%) scale(0.6) rotate(120deg); animation-delay: -1.0s;}
        .daisy-frame-item:nth-child(6) { top: 65%; left: -5px; transform: translate(-50%, 50%) scale(0.6) rotate(240deg); animation-delay: -2.0s;}

        /* --- Other Animations & Effects --- */
        @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.2); } }
        .heart-pulse { animation: pulse 1.3s ease-in-out infinite; display: inline-block; color: #f43f5e; text-shadow: 0 0 8px rgba(244, 63, 94, 0.5); }

        /* Fade-in for text */
        .fade-in { animation: fadeIn 1.5s ease-out 0.5s forwards; opacity: 0; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
        .fade-in-delay-1 { animation-delay: 1.2s; } .fade-in-delay-2 { animation-delay: 1.4s; }
        .fade-in-delay-3 { animation-delay: 1.6s; } .fade-in-delay-4 { animation-delay: 1.8s; }
        .fade-in-delay-5 { animation-delay: 2.0s; } .fade-in-delay-6 { animation-delay: 2.6s; } /* 2nd card */
        .fade-in-delay-7 { animation-delay: 2.8s; } .fade-in-delay-8 { animation-delay: 3.2s; } /* 3rd card */
        .fade-in-delay-9 { animation-delay: 3.4s; }

        /* Button styling */
        .special-button {
            background: linear-gradient(60deg, var(--accent-pink), #ec4899, var(--accent-purple));
            transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15), 0 0 10px rgba(255, 255, 255, 0.8) inset;
            transform: scale(1); border: 1px solid white; position: relative; overflow: hidden;
        }
        .special-button:hover { transform: scale(1.1); box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2), 0 0 15px rgba(255, 255, 255, 1) inset; filter: brightness(1.1); }
        .special-button:active { transform: scale(1.05); }

        /* Music Button Styling */
         .music-button {
            position: fixed; /* Keep it accessible */
            bottom: 20px; right: 20px;
            background-color: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid white;
            color: var(--accent-pink);
            width: 50px; height: 50px;
            border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            cursor: pointer; z-index: 100;
            transition: transform 0.3s ease, box-shadow 0.3s ease, background-color 0.3s ease;
         }
         .music-button:hover {
             transform: scale(1.1);
             box-shadow: 0 6px 20px rgba(0,0,0,0.15);
             background-color: rgba(255, 255, 255, 0.95);
         }
         .music-button i { font-size: 1.2rem; }

        /* Sparkle Effect */
        .sparkle {
            position: fixed; /* Use fixed to appear anywhere */
            width: 6px; height: 6px; background: white; border-radius: 50%;
            box-shadow: 0 0 6px white, 0 0 10px var(--accent-pink), 0 0 15px var(--accent-purple); /* Added purple */
            pointer-events: none; animation: sparkle-anim 0.7s ease-out forwards;
            opacity: 0; z-index: 101; /* Above music button */
        }
        @keyframes sparkle-anim { 0% { transform: scale(0.5); opacity: 1; } 100% { transform: translate(var(--tx, 0), var(--ty, 0)) scale(0); opacity: 0; } }

        /* Confetti Effect */
        .confetti {
            position: fixed; /* Use fixed */
            width: 10px; height: 10px;
            background-color: var(--confetti-1); /* Default color */
            opacity: 0.9;
            pointer-events: none;
            animation: confetti-fall 3s linear forwards;
            z-index: 101;
        }
        @keyframes confetti-fall {
            0% { transform: translateY(var(--start-y, -10vh)) translateX(var(--start-x, 0)) rotate(0deg); opacity: 1; }
            100% { transform: translateY(110vh) translateX(var(--end-x, 0)) rotate(720deg); opacity: 0; }
        }

        /* Animated Daisy Divider */
        .daisy-divider {
            height: 4px; background: linear-gradient(90deg, transparent, var(--bg-mid), var(--accent-pink), var(--bg-mid), transparent);
            background-size: 250% 100%; margin: 3rem auto; width: 90%; position: relative; border-radius: 3px;
            animation: flowGradient 5s linear infinite; box-shadow: 0 0 10px rgba(244, 114, 182, 0.3);
        }
        @keyframes flowGradient { 0% { background-position: 250% 0; } 100% { background-position: -250% 0; } }
        .daisy-divider .css-daisy { position: absolute; top: 50%; transform: translateY(-50%) scale(0.7); animation: spin 12s linear infinite, pulse-gentle 3s ease-in-out infinite; box-shadow: 0 0 8px white; }
        .daisy-divider .daisy-left { left: 5px; animation-delay: -6s, -1s; } .daisy-divider .daisy-right { right: 5px; animation-delay: 0s, -2.5s; }
        @keyframes spin { from { transform: translateY(-50%) scale(0.7) rotate(0deg); } to { transform: translateY(-50%) scale(0.7) rotate(360deg); } }

        /* Wish list item hover effect */
        .wish-item { transition: transform 0.4s ease, color 0.4s ease; padding: 5px 0; position: relative; }
        .wish-item::before { content: ''; position: absolute; bottom: 0; left: 10%; width: 0; height: 1px; background-color: var(--accent-pink); transition: width 0.4s ease; }
        .wish-item:hover { transform: translateX(10px); color: var(--accent-pink); }
        .wish-item:hover::before { width: 80%; }
        .wish-item i { transition: color 0.4s ease, transform 0.4s ease; margin-right: 10px; }
        .wish-item:hover i { color: var(--accent-purple); transform: scale(1.1) rotate(-5deg); }

        /* Interactive Wish Section */
        .wish-form-container {
            background-color: rgba(255, 255, 255, 0.5); /* Semi-transparent */
            padding: 1rem 1.5rem;
            border-radius: 20px;
            margin-top: 1.5rem;
            backdrop-filter: blur(5px);
        }
        .wish-input {
            border: 1px solid var(--accent-pink);
            border-radius: 15px;
            padding: 0.5rem 1rem;
            margin-right: 0.5rem;
            width: calc(100% - 160px); /* Adjust width based on button */
            background-color: rgba(255, 255, 255, 0.8);
            transition: box-shadow 0.3s ease;
        }
        .wish-input:focus {
            outline: none;
            box-shadow: 0 0 0 2px var(--accent-purple);
        }
        .wish-button {
            background: linear-gradient(60deg, var(--accent-pink), #ec4899);
            color: white; font-weight: bold;
            padding: 0.5rem 1rem; border-radius: 15px;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .wish-button:hover { transform: scale(1.05); box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        #wish-display {
            margin-top: 1rem;
            min-height: 2.5rem; /* Reserve space */
            text-align: center;
        }
        .wish-message {
            display: inline-block;
            background-color: var(--accent-pink);
            color: white;
            padding: 0.5rem 1.5rem;
            border-radius: 20px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.1);
            animation: wishFadeInOut 5s ease-in-out forwards;
            opacity: 0;
        }
        @keyframes wishFadeInOut {
            0% { opacity: 0; transform: translateY(10px); }
            20% { opacity: 1; transform: translateY(0); } /* Fade in */
            80% { opacity: 1; transform: translateY(0); } /* Hold */
            100% { opacity: 0; transform: translateY(-10px); } /* Fade out */
        }

    </style>
</head>
<body class="flex flex-col items-center justify-center min-h-screen">

    <div id="daisy-container"></div>

    <button id="music-toggle" class="music-button" aria-label="Play Music">
        <i class="fas fa-play"></i> </button>

    <div class="card w-full max-w-3xl p-8 md:p-14 text-center mb-10 card-delay-1">
        <h1 class="font-heading text-5xl md:text-6xl mb-5 fade-in fade-in-delay-1">
            Happy 15th Birthday, Yuki! <span class="heart-pulse">💖</span>
        </h1>
        <h2 class="text-2xl md:text-3xl font-bold text-purple-500 mb-6 fade-in fade-in-delay-2">
            Všechno nejlepší k narozeninám! <i class="fa-solid fa-cake-candles text-pink-400 animate-pulse" style="animation-duration: 1.5s;"></i>
        </h2>
        <h3 class="text-xl md:text-2xl font-bold text-rose-400 mb-10 fade-in fade-in-delay-3">
            С Днем Рождения, милая Юки! <span class="css-daisy daisy-pulse static-daisy"><span class="petal" style="transform: rotate(40deg);"></span><span class="petal" style="transform: rotate(130deg);"></span></span>
        </h3>

        <div class="mb-10 flex justify-center fade-in fade-in-delay-4">
            <div class="profile-image-container">
                 <span class="css-daisy daisy-frame-item"></span> <span class="css-daisy daisy-frame-item"></span>
                 <span class="css-daisy daisy-frame-item"></span> <span class="css-daisy daisy-frame-item"></span>
                 <span class="css-daisy daisy-frame-item"></span> <span class="css-daisy daisy-frame-item"></span>
                 <img src="https://i.ibb.co/vSh4bh0/photo-5766869897513649832-y.jpg"
                     alt="[Фото милой Юки]"
                     class="profile-image rounded-full w-52 h-52 md:w-60 md:h-60 object-cover"
                     onerror="this.onerror=null; this.src='https://placehold.co/240x240/fbcfe8/db2777?text=Yuki+:)'">
            </div>
        </div>

        <div class="text-lg text-gray-600 space-y-5 leading-relaxed fade-in fade-in-delay-5">
             <p>
                Wishing you the sweetest, most wonderful day filled with sunshine, smiles, and endless joy!
                <span class="css-daisy daisy-pulse static-daisy" style="animation-delay: -0.5s;"></span>
                Přejeme ti ten nejsladší, nejúžasnější den plný slunce, úsměvů a nekonečné radosti!
                <span class="css-daisy daisy-pulse static-daisy" style="animation-delay: -1.5s;"></span>
                Желаем тебе самого сладкого, чудесного дня, наполненного солнцем, улыбками и бесконечной радостью!
            </p>
            <p class="font-semibold text-pink-500 text-xl">
                May your 15th year sparkle with magic, laughter, and unforgettable moments! ✨ Keep being the amazing person you are!
            </p>
            <p>
                Ať tvůj 15. rok jiskří magií, smíchem a nezapomenutelnými okamžiky! <i class="fa-regular fa-star text-yellow-400 animate-spin" style="animation-duration: 4s;"></i> Zůstaň úžasnou osobou, jakou jsi! <i class="fa-solid fa-heart text-red-400 text-sm"></i>
            </p>
             <p>
                Пусть твой 15-й год искрится волшебством, смехом и незабываемыми моментами! <i class="fa-solid fa-gift text-purple-400"></i> Оставайся тем удивительным человеком, которым ты являешься! <i class="fa-solid fa-face-kiss-wink-heart text-pink-400"></i>
            </p>
        </div>

        <div class="mt-12 fade-in fade-in-delay-6">
            <button id="surprise-button" class="special-button text-white font-bold py-4 px-8 rounded-full text-xl relative">
                Click for a Little Magic! <i class="fa-solid fa-wand-magic-sparkles ml-2"></i>
            </button>
            <p id="surprise-message" class="mt-5 text-purple-600 font-semibold h-7 transition-opacity duration-500 opacity-0 text-lg"></p>
        </div>
    </div>

    <div class="card w-full max-w-3xl p-8 md:p-12 text-center mb-10 card-delay-2"> <h4 class="font-heading text-4xl mb-6 fade-in fade-in-delay-6">
            Special Wishes Just For You
            <span class="css-daisy daisy-pulse static-daisy" style="animation-delay: -2s;"></span>
         </h4>
         <div class="text-lg text-gray-600 space-y-4 fade-in fade-in-delay-7 text-left md:text-center">
            <p class="wish-item"><i class="fa-solid fa-check text-green-400"></i> Be happy, be bright, be wonderfully YOU! / Buď šťastná, zářivá, buď úžasně SVÁ! / Будь счастливой, яркой, будь чудесно СОБОЙ!</p>
            <p class="wish-item"><i class="fa-solid fa-music text-blue-400"></i> May your life's song be beautiful and joyful. / Ať je píseň tvého života krásná a radostná. / Пусть песня твоей жизни будет красивой и радостной.</p>
            <p class="wish-item"><i class="fa-solid fa-heart text-red-400"></i> Sending oceans of love on your special day! / Posílám oceány lásky v tvůj výjimečný den! / Шлю океаны любви в твой особенный день!</p>
            <p class="wish-item"><i class="fa-solid fa-rocket text-orange-400"></i> Dream big and reach for the stars! / Měj velké sny a sáhni si na hvězdy! / Мечтай по-крупному и дотянись до звезд!</p>
            <p class="wish-item"><i class="fa-solid fa-camera-retro text-teal-400"></i> May you capture countless happy memories! / Ať zachytíš nespočet šťastných vzpomínek! / Желаю запечатлеть бесчисленные счастливые воспоминания!</p>
         </div>
         <div class="daisy-divider fade-in fade-in-delay-7">
             <span class="css-daisy daisy-left"></span> <span class="css-daisy daisy-right"></span>
         </div>
         <p class="text-md text-gray-500 mt-5 fade-in fade-in-delay-7">With all our love, Your Friends <i class="fa-solid fa-users text-pink-400"></i></p>
    </div>

     <div class="card w-full max-w-3xl p-6 md:p-8 text-center card-delay-3">
        <h4 class="font-heading text-3xl mb-4 fade-in fade-in-delay-8">
            Leave a Wish! / Napiš přání! / Оставь пожелание!
            <i class="fa-regular fa-pen-to-square text-purple-400 ml-2"></i>
        </h4>
        <div class="wish-form-container fade-in fade-in-delay-9">
            <input type="text" id="wish-input" class="wish-input" placeholder="Your short wish here... / Tvé krátké přání zde..." maxlength="100">
            <button id="wish-button" class="wish-button">Send! / Odeslat!</button>
            <div id="wish-display">
                </div>
        </div>
    </div>


    <script>
        // --- Global Variables & Elements ---
        const daisyContainer = document.getElementById('daisy-container');
        const surpriseButton = document.getElementById('surprise-button');
        const surpriseMessage = document.getElementById('surprise-message');
        const musicToggleButton = document.getElementById('music-toggle');
        const musicIcon = musicToggleButton.querySelector('i');
        const wishInput = document.getElementById('wish-input');
        const wishButton = document.getElementById('wish-button');
        const wishDisplay = document.getElementById('wish-display');
        const numberOfDaisies = 30;
        let isMusicPlaying = false;
        let synth, melody; // Tone.js variables

        // --- Animated Title ---
        const titles = [
            "💖 Happy 15th, Yuki! 💖",
            "✨ Všechno nejlepší! ✨",
            "🎉 С Днем Рождения! 🎉",
            "🌼 You're Amazing! 🌼",
            "🎂 Sweet Fifteen! 🎂"
        ];
        let titleIndex = 0;
        setInterval(() => {
            document.title = titles[titleIndex];
            titleIndex = (titleIndex + 1) % titles.length;
        }, 3000); // Change title every 3 seconds


        // --- Falling Daisies ---
        function createFallingDaisy() {
            const daisy = document.createElement('span');
            daisy.className = 'css-daisy falling-daisy';
            // Add petals dynamically
            ['40deg', '130deg', '220deg', '310deg'].forEach(rot => {
                const petal = document.createElement('span');
                petal.className = 'petal'; petal.style.transform = `rotate(${rot})`;
                daisy.appendChild(petal);
            });

            daisy.style.left = `${Math.random() * 110 - 5}vw`;
            const duration = Math.random() * 10 + 10;
            const delay = Math.random() * 12;
            const scale = Math.random() * 0.3 + 0.6;
            daisy.style.animation = `fall ${duration}s linear ${delay}s infinite, sway ${Math.random() * 2 + 2}s ease-in-out infinite alternate`;
            daisy.style.transform = `scale(${scale})`;
            daisyContainer.appendChild(daisy);

            setTimeout(() => {
                 if (daisy.parentNode === daisyContainer) { daisy.remove(); createFallingDaisy(); }
            }, (duration + delay + 1) * 1000);
        }
        for (let i = 0; i < numberOfDaisies; i++) { setTimeout(createFallingDaisy, Math.random() * 8000); }

        // Add static-daisy class to relevant daisies for hover effect
        document.querySelectorAll('.card .css-daisy').forEach(el => el.classList.add('static-daisy'));


        // --- Surprise Button Logic (Sparkles + Confetti) ---
        const surpriseMessages = [ "You're magical!", "Sending sunshine & smiles!", "Hope your day is sweet!", "Keep blooming!", "Happy 15!", "You are loved!", "Make a special wish!", "Shine bright!" ];
        let surpriseMsgIndex = 0;

        function createSparkle(x, y) { /* ... (same as before) ... */
            const sparkle = document.createElement('div'); sparkle.className = 'sparkle';
            sparkle.style.left = `${x}px`; sparkle.style.top = `${y}px`;
            const tx = (Math.random() - 0.5) * 100; const ty = (Math.random() - 0.5) * 100; // Wider travel
            sparkle.style.setProperty('--tx', `${tx}px`); sparkle.style.setProperty('--ty', `${ty}px`);
            document.body.appendChild(sparkle);
            sparkle.addEventListener('animationend', () => sparkle.remove());
        }

        function createConfetti(x, y) {
            const confetti = document.createElement('div');
            confetti.className = 'confetti';
            // Random shape and color
            const colors = ['--confetti-1', '--confetti-2', '--confetti-3', '--confetti-4'];
            confetti.style.backgroundColor = `var(${colors[Math.floor(Math.random() * colors.length)]})`;
            confetti.style.left = `${x + (Math.random() - 0.5) * 30}px`; // Start near click
            confetti.style.top = `${y + (Math.random() - 0.5) * 30}px`;
            confetti.style.width = `${Math.random() * 8 + 6}px`; // Random size
            confetti.style.height = confetti.style.width;
            if (Math.random() > 0.5) { confetti.style.borderRadius = '50%'; } // Circle or square

            // Random animation parameters
            const startX = (Math.random() - 0.5) * 50; // Slight initial horizontal offset
            const endX = (Math.random() - 0.5) * 200; // Wider horizontal travel during fall
            const fallDuration = Math.random() * 2 + 2.5; // Fall duration 2.5-4.5s
            confetti.style.setProperty('--start-x', `${startX}px`);
            confetti.style.setProperty('--end-x', `${endX}px`);
            confetti.style.animation = `confetti-fall ${fallDuration}s linear forwards`;

            document.body.appendChild(confetti);
            confetti.addEventListener('animationend', () => confetti.remove());
        }

        surpriseButton.addEventListener('click', (e) => {
            // --- Message Update ---
            surpriseMessage.classList.replace('opacity-100', 'opacity-0');
            setTimeout(() => {
                 surpriseMessage.textContent = surpriseMessages[surpriseMsgIndex] + " / " + ["Jsi kouzelná!", "Posílám slunce!", "Sladký den!", "Kvést dál!", "Vše nej k 15!", "Jsi milována!", "Přej si!", "Zářit jasně!"][surpriseMsgIndex] + " / " + ["Ты волшебная!", "Шлю солнышко!", "Сладкого дня!", "Цвети!", "С 15-летием!", "Тебя любят!", "Загадай желание!", "Сияй ярко!"][surpriseMsgIndex]; // Basic multi-lang example
                 surpriseMessage.classList.replace('opacity-0','opacity-100');
                 surpriseMsgIndex = (surpriseMsgIndex + 1) % surpriseMessages.length;
            }, 500);

             // --- Sparkle & Confetti Effect ---
             const clickX = e.clientX; const clickY = e.clientY;
             for (let i = 0; i < 15; i++) { // More sparkles
                 setTimeout(() => createSparkle(clickX, clickY), Math.random() * 200);
             }
             for (let i = 0; i < 25; i++) { // Add confetti
                  setTimeout(() => createConfetti(clickX, clickY), Math.random() * 300);
             }

            // --- Button Animation ---
             surpriseButton.style.transform = 'scale(1.05)';
             setTimeout(() => { surpriseButton.style.transform = 'scale(1.1)'; }, 150);
        });

        // --- Music Setup & Control ---
        function setupMusic() {
            // Simple synth
             synth = new Tone.Synth({
                oscillator: { type: 'triangle8' }, // Softer sound
                envelope: { attack: 0.02, decay: 0.1, sustain: 0.3, release: 0.5 }
            }).toDestination();

            // Simple pleasant melody (C major scale notes)
            const notes = ["C4", "E4", "G4", "A4", "G4", "E4", "C4", null, "D4", "F4", "A4", "G4", "F4", "D4", null, null];
            melody = new Tone.Sequence((time, note) => {
                if (note) {
                    synth.triggerAttackRelease(note, "8n", time);
                }
            }, notes, "4n"); // Play each note as a quarter note

            melody.loop = true; // Loop the melody
            Tone.Transport.bpm.value = 90; // Slower tempo
        }

        musicToggleButton.addEventListener('click', async () => {
            // Start Tone context on first interaction
            await Tone.start();

            if (!synth) { // Setup music only once
                 setupMusic();
            }

            if (isMusicPlaying) {
                Tone.Transport.stop();
                melody.stop(); // Ensure sequence stops
                musicIcon.classList.remove('fa-stop');
                musicIcon.classList.add('fa-play');
                musicToggleButton.setAttribute('aria-label', 'Play Music');
            } else {
                Tone.Transport.start();
                melody.start(0); // Start sequence immediately
                musicIcon.classList.remove('fa-play');
                musicIcon.classList.add('fa-stop');
                 musicToggleButton.setAttribute('aria-label', 'Stop Music');
            }
            isMusicPlaying = !isMusicPlaying;
        });


        // --- Interactive Wish Logic ---
        let wishTimeout; // To clear previous fadeout timer

        wishButton.addEventListener('click', () => {
            const message = wishInput.value.trim();
            if (message) {
                // Clear previous message and timeout if exists
                wishDisplay.innerHTML = '';
                clearTimeout(wishTimeout);

                // Create new message element
                const wishEl = document.createElement('div');
                wishEl.className = 'wish-message';
                // Sanitize message simply by setting textContent
                const icon = '<i class="fa-regular fa-comment-dots text-sm mr-2"></i>';
                wishEl.innerHTML = icon;
                wishEl.appendChild(document.createTextNode(message)); // Append text safely

                wishDisplay.appendChild(wishEl);
                wishInput.value = ''; // Clear input

                // Set timeout to remove the message (animation handles fade)
                wishTimeout = setTimeout(() => {
                     if (wishEl.parentNode === wishDisplay) { // Check if still exists
                         wishDisplay.removeChild(wishEl);
                     }
                }, 5000); // Match animation duration
            }
        });
        // Allow sending wish with Enter key
        wishInput.addEventListener('keypress', (e) => {
             if (e.key === 'Enter') {
                 wishButton.click();
             }
        });

        // --- Button Hover Reset Logic --- (same as before)
         surpriseButton.addEventListener('mouseleave', () => { setTimeout(() => { if (!surpriseButton.matches(':hover')) { surpriseButton.style.transform = 'scale(1)'; } }, 200); });
         surpriseButton.addEventListener('mouseenter', () => { surpriseButton.style.transform = 'scale(1.1)'; });

    </script>
</body>
</html>
